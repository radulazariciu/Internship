//>>built
define("epi-ecf-ui/widget/viewmodel/CatalogContentListViewModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","epi/shell/ClipboardManager","epi/shell/command/_CommandProviderMixin","epi/shell/selection","epi/shell/command/withConfirmation","epi-cms/widget/ContentTreeModelConfirmation","epi-cms/widget/CreateCommandsMixin","epi-cms/component/command/ChangeContext","epi-cms/command/NewContent","epi-cms/command/CopyContent","epi-cms/command/CutContent","epi-cms/command/DeleteContent","./CatalogTreeStoreModel","../../command/DetachFromCategory","../../command/PasteCatalogContent","../../component/DeleteCatalogContentHandler","epi/i18n!epi/cms/nls/commerce.widget.catalogcontentlist","epi/i18n!epi/nls/episerver.shared"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14){return _2([_5,_9],{model:null,treeStoreModel:null,res:_13,clipboardManager:null,selection:null,_commandRegistry:null,numSelectedRows:null,postscript:function(){this.clipboardManager=this.clipboardManager||new _4();this.selection=this.selection||new _6();this.repositoryKey="catalog";this.inherited(arguments);this._setupCommands();},getSelectionCommands:function(){return [this._commandRegistry.cut.command,this._commandRegistry.copy.command,this._commandRegistry.pasteOnContext.command,this._commandRegistry.detach.command,this._commandRegistry.remove.command];},_setupCommands:function(){this.treeStoreModel=new _f();this.treeStoreModel.roots=this.roots;var _15=_8(this.treeStoreModel);var _16={category:"context",clipboard:this.clipboardManager,selection:this.selection,model:_15};var _17=_3.mixin({toolbarGroup:"clipboard"},_16);var _18=new _e(_3.mixin({model:this.treeStoreModel},_16));this._commandRegistry=_3.mixin(this.getCreateCommands(),{edit:{command:new _a({category:"context",forceContextChange:true,viewName:"formedit"}),order:-1},cut:{command:new _d(_17),order:101},copy:{command:new _c(_17),order:102},paste:{command:new _11(_16),order:103},pasteOnContext:{command:new _11(_3.mixin(_17,{selection:new _6()}))},detach:{command:_7(new _10(_16),null,{title:this.res.detachconfirmation.title,description:this.res.detachconfirmation.description}),order:104},remove:{command:_7(_18,_12,{title:this.res.deleteconfirmation.title,description:this.res.deleteconfirmation.description,confirmActionText:_14.action.deletelabel,cancelActionText:_14.action.cancel}),order:105},sort:function(){var _19=[];for(var key in this){if(key!=="toArray"&&key!=="sort"&&this.hasOwnProperty(key)&&key!=="pasteOnContext"){var _1a=this[key].order;if(!_1a){_1a=100;}_19.push([_1a,this[key].command]);}}_19.sort(function(a,b){return a[0]-b[0];});return _19;},toArray:function(){var _1b=this.sort();var _1c=[];_1.forEach(_1b,function(key){_1c.push(key[1]);});return _1c;}});this.set("commands",this._commandRegistry.toArray());},_modelSetter:function(_1d){this.model=_1d;var _1e=_1d;if(_1d&&_1d.data){_1e=_1d.data;}this._commandRegistry.edit.command.set("model",_1e);for(var cmd in this._commandRegistry){var _1f=this._commandRegistry[cmd].command||{};if(_1f instanceof _b||_1f.popup){_1f.set("model",_1e);}}this.updateSelection(_1e);},updateSelection:function(_20){var _21=[];if(_20){this.numSelectedRows=_20.length;_21=_1.map(_20,function(_22){return {type:"epi.cms.contentdata",data:_22,contextId:this.model?this.model.contextId:null};},this);}if(this.selection){this.selection.set("data",_21);}},destroy:function(){this.treeStoreModel.destroy();delete this.treeStoreModel;}});});