//>>built
define("epi-ecf-ui/contentediting/editors/_RelationCollectionEditorBase",["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","dojo/when","dojo/aspect","dojo/dom-construct","dojo/dom-class","dgrid/Keyboard","dgrid/OnDemandGrid","dgrid/Selection","dgrid/extensions/ColumnResizer","dgrid/extensions/ColumnReorder","epi/dependency","epi/shell/dgrid/Formatter","epi-cms/contentediting/editors/CollectionEditor","epi-cms/contentediting/editors/model/CollectionEditorModel","epi-cms/dgrid/DnD","epi-cms/dgrid/WithContextMenu","epi-cms/widget/ContentSelectorDialog","./RelationCollectionGridAssembler","../ModelSupport","./LinkEditorDndMixin","../../dgrid/_ClickablePathColumnMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,DnD,_11,_12,_13,_14,_15,_16){return _1([_f,_15],{templateString:"<div>                            <div data-dojo-attach-point=\"commandTargetNode\"></div>                            <div data-dojo-attach-point=\"overlayDnd\">                                <div class=\"epi-associationCollectionEditor\" data-dojo-attach-point=\"gridNode\"></div>                            <div>                        </div>",resources:null,gridOverlayClass:"epi-grid-dnd-overlay",itemType:"EPiServer.Commerce.AddOns.UI.Rest.Models.RelationModel",itemEditorTypes:null,storeKey:"epi.commerce.relation",itemEditorType:_12,commands:_10.commandMask.remove,gridAssemblerType:_13,gridType:_1([_9,_e,_a,_8,DnD,_b,_c,_11,_16]),postMixInProperties:function(){this.inherited(arguments);var _17=_d.resolve("epi.storeregistry");this._store=this._store||_17.get(this.storeKey);if(!this.roots){var _18=_d.resolve("epi.cms.contentRepositoryDescriptors");var _19=_18["catalog"];this.roots=_19.roots;}this.gridSettings=_2.mixin(this.gridSettings||{},{useDeleteWithConfirmation:true,dndSourceTypes:[_14.linkTypeIdentifier.relation],deleteConfirmationTitle:this.resources.deleteconfirmation.title,deleteConfirmationMessage:this.resources.deleteconfirmation.description});},_dndNodeCreator:function(_1a,_1b){var _1c=this.allowedDndTypes,_1d=_6.create("div").appendChild(document.createTextNode(_1a.name));return {"node":_1d,"type":_1c,"data":_1a};},onExecuteDialog:function(){var _1e=this._itemEditor.get("value");this.model.addItem(this._createItem(_1e));},_renderNoDataMessage:function(){this.grid.set("noDataMessage",this.resources.nodatamessage);this.inherited(arguments);},_getDialogTitleText:function(){return this.resources.addlabel;},_createItemEditor:function(){return new this.itemEditorType({canSelectOwnerContent:false,showButtons:false,roots:this.roots,allowedTypes:this.itemEditorTypes,showAllLanguages:false});},_dndGetItemData:function(_1f){return _4(_1f.data,_2.hitch(this,function(_20){if(_20){return this._createItem(_20.contentLink,_20.name);}}));},_createItem:function(_21,_22){return {name:_22||_21,sortOrder:0,source:this.model.get("data"),target:_21,type:this.relationType};},_setupDnD:function(){this.inherited(arguments);this.setupDndActions(this.grid.dndSource,"checkAcceptance");this.own(_5.after(this.grid.dndSource,"onDndStart",_2.hitch(this,function(_23,_24,_25){var _26=this.grid.dndSource,_27=_26.accept&&_26.checkAcceptance(_23,_24);_7[_27?"add":"remove"](this.overlayDnd,this.gridOverlayClass);}),true));}});});